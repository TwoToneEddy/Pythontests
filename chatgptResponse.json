{
    "id": "chatcmpl-706F77pLG2gekXyhvbcZzNmdNRLAR",
    "object": "chat.completion",
    "created": 1680258353,
    "model": "gpt-3.5-turbo-0301",
    "usage": {
        "prompt_tokens": 268,
        "completion_tokens": 2532,
        "total_tokens": 2800
    },
    "choices": [
        {
            "message": {
                "role": "assistant",
                "content": "[{\n    \"id\": \"fd2125c5.a5caa\",\n    \"type\": \"inject\",\n    \"z\": \"fcded00e.367fd8\",\n    \"name\": \"Start Test\",\n    \"topic\": \"\",\n    \"payload\": \"start\",\n    \"payloadType\": \"str\",\n    \"repeat\": \"\",\n    \"crontab\": \"\",\n    \"once\": false,\n    \"onceDelay\": 0.1,\n    \"x\": 130,\n    \"y\": 220,\n    \"wires\": [\n        [\"e0eae9b6.5a6a5\"]\n    ]\n},\n{\n    \"id\": \"a40f06ca.4d7fe8\",\n    \"type\": \"inject\",\n    \"z\": \"fcded00e.367fd8\",\n    \"name\": \"Stop Test\",\n    \"topic\": \"\",\n    \"payload\": \"stop\",\n    \"payloadType\": \"str\",\n    \"repeat\": \"\",\n    \"crontab\": \"\",\n    \"once\": false,\n    \"onceDelay\": 0.1,\n    \"x\": 130,\n    \"y\": 260,\n    \"wires\": [\n        [\"2aa3d3b7.1b76e8\"]\n    ]\n},\n{\n    \"id\": \"d42986ac.e7729\",\n    \"type\": \"inject\",\n    \"z\": \"fcded00e.367fd8\",\n    \"name\": \"Reset\",\n    \"topic\": \"\",\n    \"payload\": \"reset\",\n    \"payloadType\": \"str\",\n    \"repeat\": \"\",\n    \"crontab\": \"\",\n    \"once\": false,\n    \"onceDelay\": 0.1,\n    \"x\": 130,\n    \"y\": 300,\n    \"wires\": [\n        [\"fe703cae.ae56c8\"]\n    ]\n},\n{\n    \"id\": \"13f0b1b8.e233f2\",\n    \"type\": \"function\",\n    \"z\": \"fcded00e.367fd8\",\n    \"name\": \"Calculate AH\",\n    \"func\": \"let ah = context.get('ah') || 0;\\n\\nif (msg.payload == 'start') {\\n    context.set('startTime', Date.now());\\n    context.set('startAh', ah);\\n}\\nelse if (msg.payload == 'stop') {\\n    let elapsed = (Date.now() - context.get('startTime')) / 3600000;\\n    let discharged = context.get('startAh') - ah;\\n    let average = discharged / elapsed;\\n    msg.payload = `Discharged: ${discharged.toFixed(1)} Ah | Average: ${average.toFixed(2)} A`;\\n    return msg;\\n}\\nelse if (msg.payload == 'reset') {\\n    context.set('ah', 0);\\n    return msg;\\n}\\n\\nlet voltage = parseFloat(context.get('batteryVoltage'));\\nlet current = parseFloat(context.get('batteryCurrent'));\\nlet power = voltage * current;\\n\\nah += current * (msg.interval / 3600000);\\ncontext.set('ah', ah);\\n\\nmsg.payload = `Voltage: ${voltage.toFixed(1)} V | Current: ${current.toFixed(2)} A | Power: ${power.toFixed(1)} W | AH: ${ah.toFixed(1)} Ah`;\\nreturn msg;\",\n    \"outputs\": 1,\n    \"noerr\": 0,\n    \"initialize\": \"\",\n    \"finalize\": \"\",\n    \"x\": 700,\n    \"y\": 220,\n    \"wires\": [\n        [\"6c74d335.e8db2\"]\n    ]\n},\n{\n    \"id\": \"6c74d335.e8db2\",\n    \"type\": \"debug\",\n    \"z\": \"fcded00e.367fd8\",\n    \"name\": \"\",\n    \"active\": true,\n    \"tosidebar\": true,\n    \"console\": false,\n    \"tostatus\": false,\n    \"complete\": \"payload\",\n    \"targetType\": \"msg\",\n    \"statusVal\": \"\",\n    \"statusType\": \"auto\",\n    \"x\": 850,\n    \"y\": 220,\n    \"wires\": []\n},\n{\n    \"id\": \"e62559f5.fc5cf\",\n    \"type\": \"redplc-cpu\",\n    \"z\": \"fcded00e.367fd8\",\n    \"name\": \"\",\n    \"sw\": \"v0.0.1\",\n    \"modbusEnabled\": true,\n    \"broker\": \"9054b4ab.4c49a8\",\n    \"x\": 160,\n    \"y\": 480,\n    \"wires\": [[\"605611c1.f63034\"], []]\n},\n{\n    \"id\": \"605611c1.f63034\",\n    \"type\": \"mcp342x\",\n    \"z\": \"fcded00e.367fd8\",\n    \"mcp342x_id\": \"6fd58fd6.ee7e2\",\n    \"channel\": 0,\n    \"interval\": \"200\",\n    \"samples\": \"1\",\n    \"name\": \"Battery Voltage\",\n    \"x\": 370,\n    \"y\": 420,\n    \"wires\": [[\"f1b67935.5138a\"]]\n},\n{\n    \"id\": \"f1b67935.5138a\",\n    \"type\": \"function\",\n    \"z\": \"fcded00e.367fd8\",\n    \"name\": \"Store Battery Voltage\",\n    \"func\": \"let voltage = parseFloat(msg.payload);\\ncontext.set('batteryVoltage', voltage);\\n\\nreturn msg;\",\n    \"outputs\": 1,\n    \"noerr\": 0,\n    \"initialize\": \"\",\n    \"finalize\": \"\",\n    \"x\": 620,\n    \"y\": 420,\n    \"wires\": [[\"13f0b1b8.e233f2\"]]\n},\n{\n    \"id\": \"9af84d7e.d12638\",\n    \"type\": \"inject\",\n    \"z\": \"fcded00e.367fd8\",\n    \"name\": \"Toggle Load\",\n    \"topic\": \"\",\n    \"payload\": \"true\",\n    \"payloadType\": \"bool\",\n    \"repeat\": \"\",\n    \"crontab\": \"\",\n    \"once\": false,\n    \"onceDelay\": 0.1,\n    \"x\": 130,\n    \"y\": 180,\n    \"wires\": [\n        [\"6c8cb6ed.e81d08\"]\n    ]\n},\n{\n    \"id\": \"6c8cb6ed.e81d08\",\n    \"type\": \"function\",\n    \"z\": \"fcded00e.367fd8\",\n    \"name\": \"Toggle Relay\",\n    \"func\": \"let state = context.get('relayState') || false;\\n\\nif (msg.payload) {\\n    state = !state;\\n    context.set('relayState', state);\\n}\\n\\nmsg.payload = state;\\n\\nreturn msg;\",\n    \"outputs\": 1,\n    \"noerr\": 0,\n    \"initialize\": \"\",\n    \"finalize\": \"\",\n    \"x\": 320,\n    \"y\": 180,\n    \"wires\": [\n        [\"90377d4a.1fe138\"]\n    ]\n},\n{\n    \"id\": \"90377d4a.1fe138\",\n    \"type\": \"rpi-gpio out\",\n    \"z\": \"fcded00e.367fd8\",\n    \"name\": \"Relay\",\n    \"pin\": \"13\",\n    \"set\": \"\",\n    \"level\": \"0\",\n    \"freq\": \"\",\n    \"out\": \"out\",\n    \"x\": 490,\n    \"y\": 180,\n    \"wires\": []\n},\n{\n    \"id\": \"feb8b62d.cd2628\",\n    \"type\": \"redplc-cpu\",\n    \"z\": \"fcded00e.367fd8\",\n    \"name\": \"\",\n    \"sw\": \"v0.0.1\",\n    \"modbusEnabled\": true,\n    \"broker\": \"9054b4ab.4c49a8\",\n    \"x\": 160,\n    \"y\": 540,\n    \"wires\": [[\"901850fe.ff26c\"], []]\n},\n{\n    \"id\": \"901850fe.ff26c\",\n    \"type\": \"mcp342x\",\n    \"z\": \"fcded00e.367fd8\",\n    \"mcp342x_id\": \"6fd58fd6.ee7e2\",\n    \"channel\": 1,\n    \"interval\": \"200\",\n    \"samples\": \"1\",\n    \"name\": \"Battery Current\",\n    \"x\": 370,\n    \"y\": 540,\n    \"wires\": [[\"db9b165f.64269\"]]\n},\n{\n    \"id\": \"db9b165f.64269\",\n    \"type\": \"function\",\n    \"z\": \"fcded00e.367fd8\",\n    \"name\": \"Store Battery Current\",\n    \"func\": \"let current = parseFloat(msg.payload);\\ncontext.set('batteryCurrent', current);\\n\\nreturn msg;\",\n    \"outputs\": 1,\n    \"noerr\": 0,\n    \"initialize\": \"\",\n    \"finalize\": \"\",\n    \"x\": 620,\n    \"y\": 540,\n    \"wires\": [[\"13f0b1b8.e233f2\"]]\n},\n{\n    \"id\": \"fe703cae.ae56c8\",\n    \"type\": \"function\",\n    \"z\": \"fcded00e.367fd8\",\n    \"name\": \"Reset Test\",\n    \"func\": \"context.set('ah', 0);\\ncontext.set('relayState', false);\\n\\nlet msg = { payload: false };\\n\\nreturn [msg, { payload: 'reset' }];\",\n    \"outputs\": 2,\n    \"noerr\": 0,\n    \"initialize\": \"\",\n    \"finalize\": \"\",\n    \"x\": 320,\n    \"y\": 300,\n    \"wires\": [\n        [\"90377d4a.1fe138\"],\n        [\"13f0b1b8.e233f2\"]\n    ]\n},\n{\n    \"id\": \"2aa3d3b7.1b76e8\",\n    \"type\": \"function\",\n    \"z\": \"fcded00e.367fd8\",\n    \"name\": \"Stop Test\",\n    \"func\": \"context.set('relayState', false);\\nreturn { payload: 'stop' };\",\n    \"outputs\": 1,\n    \"noerr\": 0,\n    \"initialize\": \"\",\n    \"finalize\": \"\",\n    \"x\": 320,\n    \"y\": 260,\n    \"wires\": [\n        [\"90377d4a.1fe138\"]\n    ]\n},\n{\n    \"id\": \"9054b4ab.4c49a8\",\n    \"type\": \"mqtt-broker\",\n    \"name\": \"\",\n    \"broker\": \"localhost\",\n    \"port\": \"1883\",\n    \"clientid\": \"\",\n    \"usetls\": false,\n    \"compatmode\": false,\n    \"keepalive\": \"60\",\n    \"cleansession\": true,\n    \"birthTopic\": \"\",\n    \"birthQos\": \"0\",\n    \"birthPayload\": \"\",\n    \"closeTopic\": \"\",\n    \"closeQos\": \"0\",\n    \"closePayload\": \"\",\n    \"willTopic\": \"\",\n    \"willQos\": \"0\",\n    \"willPayload\": \"\"\n},\n{\n    \"id\": \"6fd58fd6.ee7e2\",\n    \"type\": \"mcp342x-config\",\n    \"z\": \"\",\n    \"deviceId\": \"48\",\n    \"voltageRange\": \"3.3\",\n    \"pga\": \"1\",\n    \"sps\": \"15\"\n}]"
            },
            "finish_reason": "stop",
            "index": 0
        }
    ]
}